<template>
    <div class="create-profile">
        <div class="container">
            <div class="row">
                <a class="back-btn" @click.prevent="$router.go(-1)">‚Üê</a>
                <h1 class="Title">Edit Information</h1>
                <small class="must-input">* Ë°®Á§∫ÂøÖÂ°´È°π</small>
                <!-- formË°®Âçï -->
                <form @submit.prevent="submit">
                    <p><input class="Input"
                        type='text'
                        name='handle'
                        placeholder="* Profile handle"
                        v-model="msgInfo.handle"
                        :error='errors.handle'
                    /></p>
                    <SelectList 
                        name="status"
                        :error="errors.status"
                        v-model="msgInfo.status"
                        :options="options"
                    />
                    <p><input class="Input"
                        type='text'
                        name='company'
                        placeholder="ÂèØ‰ª•ÊòØ‰Ω†Ëá™Â∑±ÁöÑÂÖ¨Âè∏ÊàñËÄÖÊòØ‰Ω†ÁöÑÂú®ËÅåÂÖ¨Âè∏"
                        v-model="msgInfo.company"
                        :error='errors.company'
                    /></p>
                    <p><input class="Input"
                        type='text'
                        name='website'
                        placeholder="‰Ω†ÂÖ¨Âè∏ÁΩëÂùÄÊàñËÄÖÊòØ‰Ω†Âú®ËÅåÂÖ¨Âè∏ÁΩëÂùÄ"
                        v-model="msgInfo.website"
                        :error='errors.website'
                    /></p>
                    <p><input class="Input"
                        type='text'
                        name='location'
                        placeholder="‰Ω†ÊâÄÂú®ÁöÑÂüéÂ∏ÇÂèäÊâÄÂú®Âå∫ (‰æãÂ¶Ç. Âåó‰∫¨Â∏ÇÊòåÂπ≥Âå∫)"
                        v-model="msgInfo.location"
                        :error='errors.location'
                    /></p>
                    <p><input class="Input"
                        type='text'
                        name='skills'
                        placeholder="ÁºñÁ®ãËØ≠Ë®ÄÊäÄËÉΩ (‰æãÂ¶Ç: HTML,CSS,JavaScript,PHP)"
                        v-model="msgInfo.skills"
                        :error='errors.skills'
                    /></p>
                    <p><input class="Input"
                        type='text'
                        name='githubusername'
                        placeholder="Github Áî®Êà∑Âêç"
                        v-model="msgInfo.githubusername"
                        :error='errors.githubusername'
                    /></p>
                    <TextArea
                        placeholder="Ëá™Êàë‰ªãÁªç"
                        name='bio'
                        v-model="msgInfo.bio"
                        :error='errors.bio'
                    ></TextArea>
                    <div>
                        <button type="button" class="choose-btn" @click="displaySocialInputs = !displaySocialInputs">Add Social Account</button>
                        <!-- <span>ÈÄâÈ°π</span> -->
                    </div>
                    <div v-show="displaySocialInputs">
                        <InputGroup
                          placeholder="WeChat"
                          name="wechat"
                          v-model="msgInfo.wechat"
                          :error='errors.wechat'
                        ></InputGroup>
                        <InputGroup
                          placeholder="QQ"
                          name="QQ"
                          v-model="msgInfo.QQ"
                          :error='errors.QQ'
                        ></InputGroup>
                        <InputGroup
                          placeholder="ËÖæËÆØËØæÂ†Ç"
                          name="tengxunkt"
                          v-model="msgInfo.tengxunkt"
                          :error='errors.tengxunkt'
                        ></InputGroup>
                        <InputGroup
                          placeholder="ÁΩëÊòì‰∫ëËØæÂ†Ç"
                          name="wangyikt"
                          v-model="msgInfo.wangyikt"
                          :error='errors.wangyikt'
                        ></InputGroup>
                    </div>
                    <input type="submit" class="submit-btn" value="‚Üí"/>
                </form>
                <span class="line-top"></span>
                <span class="line line-left"></span>
                <span class="line line-right"></span>
                <span class="line line-bottom"></span>
            </div>
        </div>
    </div>
</template>

<script>
import TextArea from './common/TextAreaGroup';
import SelectList from './common/SelectListGroup';
import InputGroup from './common/InputGroup';
export default {
    name:'CreateProfile',
    data() {
        return {
            msgInfo: {
                handle: "",
                company: "",
                website: "",
                location: "",
                status: "ËØ∑ÈÄâÊã©ÊÇ®ÁöÑËÅå‰∏ö",
                skills: "",
                githubusername: "",
                bio: "",
                wechat: "",
                QQ: "",
                tengxunkt: "",
                wangyikt: ""
            },
            errors:{},
            displaySocialInputs:false,
            options: [
                { label: "0", value: "ËØ∑ÈÄâÊã©ÊÇ®ÁöÑËÅå‰∏ö" },
                { label: "Junior Developer", value: "ÂâçÁ´ØÂàùÁ∫ßÂ∑•Á®ãÂ∏à" },
                { label: "Senior Developer", value: "ÂâçÁ´Ø‰∏≠Á∫ßÂ∑•Á®ãÂ∏à" },
                { label: "HighDeveloper", value: "ÂâçÁ´ØÈ´òÁ∫ßÂ∑•Á®ãÂ∏à" },
                { label: "Manager", value: "ÂâçÁ´ØÁÆ°ÁêÜ" },
                { label: "backend Developer", value: "ÂêéÁ´ØÂºÄÂèë" },
                { label: "Python machine learning", value: "PythonÊú∫Âô®Â≠¶‰π†" },
                { label: "Other", value: "ÂÖ∂‰ªñ" }
            ],
        }
    },
    components:{
        TextArea,
        SelectList,
        InputGroup
    },
    beforeRouteEnter(to,from,next){
        next(vm =>{
            // let profile = vm.$store.getters.profile;
            // vm.msgInfo = profile;
            vm.getCurrentProfile();
        })
    },
    methods: {
        submit(){
            //axiosÂèëÈÄÅÊï∞ÊçÆÂà∞Êé•Âè£
            this.$axios.post("http://localhost:5000/api/profile",this.msgInfo)
            .then((res) => {
                //Ê∏ÖÁ©∫ÈîôËØØ
                this.errors = {};
                this.$store.dispatch("setProfile",res.data);
                this.$router.push('/dashboard');
            }).catch((err) =>{
                this.errors = err.response.data;
                alert("add fail  üëâ  ‰ø°ÊÅØÂ°´ÂÜôÊúâËØØ")
            });
        },
        getCurrentProfile(){
                let profile = this.$store.getters.profile;

                profile.company = profile.company ? profile.company : "";
                profile.website = profile.website ? profile.website : "";
                profile.location = profile.location ? profile.company : "";
                profile.githubusername = profile.githubusername
                    ? profile.githubusername
                    : "";
                profile.bio = profile.bio ? profile.bio : "";

                profile.social = profile.social ? profile.social : {};
                profile.wechat = profile.social.wechat ? profile.social.wechat : "";
                profile.QQ = profile.social.QQ ? profile.social.QQ : "";
                profile.tengxunkt = profile.social.tengxunkt
                    ? profile.social.tengxunkt
                    : "";
                profile.wangyikt = profile.social.wangyikt ? profile.social.wangyikt : "";
                profile.skills = profile.skills.length ? profile.skills.join(",") : "";
                
                this.msgInfo = profile;
        }
    },
}
</script>

<style scoped>
.create-profile{
    position: relative;
    background:url("../assets/landing.jpg") no-repeat;
    background-size: cover;
    background-position: center;
    height:100%;
    min-height: 1200px;
    color:#fff;
    /* opacity:0.9; */
}
.container{
    position: absolute;
    top:50px;
    left:30%;
    width:600px;
    height:auto;
    text-align: left;
}
.row{
    position: relative;
    padding:10px 20px 50px 20px;
}
.back-btn{
    cursor:pointer;
    font-size:20px;
}
.back-btn:hover{
    transition:0.5s ease;
    color:rgb(247, 68, 68);
}
.Title{
    margin:20px;
}
/*----------------------------------------------------------------------------------*/
.line-top{
    background:#fff;
    position:absolute;
    height:2px;
    width:100%;
    left:0px;
    top:0px;
    animation:topmove 4s 1;
    -moz-animation:topmove 4s 1; /* Firefox */
    -webkit-animation:topmove 4s 1; /* Safari and Chrome */
    -o-animation:topmove 4s 1; /* Opera */
}
@keyframes topmove
{
from {width:0%;}
to {width:100%;}
}
@-moz-keyframes topmove /* Firefox */
{
from {width:0%;}
to {width:100%;}
}
@-webkit-keyframes topmove /* Safari and Chrome */
{
from {width:0%;}
to {width:100%;}
}
@-o-keyframes topmove /* Opera */
{
from {width:0%;}
to {width:100%;}
}
.line-bottom{
    background:#fff;
    position:absolute;
    height:2px;
    width:100%;
    right:0px;
    bottom:0px;
    animation:bottommove 4s 1;
    -moz-animation:bottommove 4s 1; /* Firefox */
    -webkit-animation:bottommove 4s 1; /* Safari and Chrome */
    -o-animation:bottommove 4s 1; /* Opera */
}
@keyframes bottommove
{
from {width:0%;}
to {width:100%;}
}
@-moz-keyframes bottommove /* Firefox */
{
from {width:0%;}
to {width:100%;}
}
@-webkit-keyframes bottommove /* Safari and Chrome */
{
from {width:0%;}
to {width:100%;}
}
@-o-keyframes bottommove /* Opera */
{
from {width:0%;}
to {width:100%;}
}
.line-left{
    background:#fff;
    position:absolute;
    height:100%;
    width:2px;
    left:0px;
    bottom:0px;
    animation:leftmove 4s 1;
    -moz-animation:leftmove 4s 1; /* Firefox */
    -webkit-animation:leftmove 4s 1; /* Safari and Chrome */
    -o-animation:leftmove 4s 1; /* Opera */
}
@keyframes leftmove
{
from {height:0%;}
to {height:100%;}
}
@-moz-keyframes leftmove /* Firefox */
{
from {height:0%;}
to {height:100%;}
}
@-webkit-keyframes leftmove /* Safari and Chrome */
{
from {height:0%;}
to {height:100%;}
}
@-o-keyframes leftmove /* Opera */
{
from {height:0%;}
to {height:100%;}
}
.line-right{
    background:#fff;
    position:absolute;
    height:100%;
    width:2px;
    right:0px;
    top:0px;
    animation:rightmove 4s 1;
    -moz-animation:rightmove 4s 1; /* Firefox */
    -webkit-animation:rightmove 4s 1; /* Safari and Chrome */
    -o-animation:rightmove 4s 1; /* Opera */
}
@keyframes rightmove
{
from {height:0%;}
to {height:100%;}
}
@-moz-keyframes rightmove /* Firefox */
{
from {height:0%;}
to {height:100%;}
}
@-webkit-keyframes rightmove /* Safari and Chrome */
{
from {height:0%;}
to {height:100%;}
}
@-o-keyframes rightmove /* Opera */
{
from {height:0%;}
to {height:100%;}
}
/*------------------------------------------------------------------*/
/*placeholderÂ≠ó‰Ωì*/
::-webkit-input-placeholder { /* WebKit browsers */
  color: #fff;
  font-size: 12px;
}

::-moz-placeholder { /* Mozilla Firefox 19+ */
  color: #fff;
  font-size: 12px;
}

:-ms-input-placeholder { /* Internet Explorer 10+ */
  color: #fff;
  font-size: 12px;
}   
.Input{
    border:1px solid #fff;
    width:350px;
    height:30px;
    margin-bottom:10px;
    border-radius: 3px;
    text-indent:10px;
    font-size:12px;
    background:transparent;
    color:#fff;  
    font-weight:bold;
}
/*------------------------------------------------------------------*/
.choose-btn{
    margin-top:15px;
    border:1px solid #fff;
    background:transparent;
    border-radius: 3px;
    color:#fff;
    width:150px;
    height:30px;
}
.choose-btn:hover{
    background:rgb(32, 141, 90);
    border:1px solid rgb(32, 141, 90);
    transition:0.4s ease;
}
.submit-btn{
    margin-top:20px;
    background:rgb(32, 141, 90);
    border:1px solid rgb(32, 141, 90);
    border-radius: 3px;
    color:#fff;
    width:70px;
    padding-left:10px;
    text-align:left;
}
.submit-btn:hover{
    background:rgb(23, 99, 63);
    border:1px solid rgb(23, 99, 63);
    padding-left:40px;
    transition:0.5s ease;
}
</style>
